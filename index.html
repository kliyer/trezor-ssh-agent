<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="trezor-ssh-agent : Trezor SSH Agent for Windows (Putty, WinSCP and more)">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>trezor-ssh-agent</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/martin-lizner/trezor-ssh-agent">View on GitHub</a>

          <h1 id="project_title">trezor-ssh-agent</h1>
          <h2 id="project_tagline">Trezor SSH Agent for Windows (Putty, WinSCP and more)</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/martin-lizner/trezor-ssh-agent/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/martin-lizner/trezor-ssh-agent/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>Status: <a href="https://travis-ci.org/martin-lizner/trezor-ssh-agent"><img src="https://travis-ci.org/martin-lizner/trezor-ssh-agent.svg?branch=master" alt="Build Status"></a></p>

<h2>
<a id="trezor-ssh-agent-for-windows-putty-winscp-and-more" class="anchor" href="#trezor-ssh-agent-for-windows-putty-winscp-and-more" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Trezor SSH Agent for Windows (Putty, WinSCP and more)</h2>

<ul>
<li>Supported devices: Trezor, KeepKey (see KeepKey Users section)</li>
</ul>

<p>Trezor SSH Agent is Windows application that enables users to authenticate to UNIX/Linux SSH server using their favorite apps like Putty, WinSCP or other Pageant-compatible clients (e.g. git) together hardware bitcoin wallets.
Trezor SSH Agent is a GUI-enabled tray application that emulates Pageant process in Windows. It receives identity requests from SSH client (which gets it from SSH server), uses wallet hardware to sign challenge and sends data back.</p>

<p>It is absolutely safe to use Trezor SSH Agent. No harm can be caused to your bitcoins or the wallet. Application never asks device for any Bitcoin related action, e.g. it never asks to sign tx.</p>

<h3>
<a id="limitations" class="anchor" href="#limitations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Limitations</h3>

<ul>
<li>Only ecdsa-sha2-nistp256 key is supported at current. ssh-ed25519 may come in future depending on device HW support. ssh-rsa is not supported by device HW.</li>
<li>No other device app (like myTREZOR webpage or KeepKey Chrome extension) can be running simultaneously.</li>
<li>Pageant cannot run simultaneously. </li>
<li>BIP32 path is fixed by constant Identity URI. In PIN-only mode this produces just one public key per device. Turning on passphrase security on your device gives you unique key per every passhrase. Alternatively you can change the path in the settings file (see Advanced) </li>
<li>There are small <a href="https://github.com/bitcoin-solutions/multibit-hardware/issues/29">troubles</a> on USB level that makes device init last a bit longer (10-20 sec) in certain situations.</li>
</ul>

<h3>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started</h3>

<h4>
<a id="start" class="anchor" href="#start" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Start</h4>

<ul>
<li>Download and run JAR or EXE binary from latest release.</li>
<li>Java 1.7 or later is required.</li>
<li>Or you can build your own java (see bellow) and run class com.trezoragent.gui.StartAgentGUI main.</li>
</ul>

<h4>
<a id="build" class="anchor" href="#build" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Build</h4>

<p>Trezor SSH Agent uses the standard Maven build process and can be used without having external hardware attached. Just do the usual:</p>

<pre><code>$ cd &lt;project directory&gt;
$ mvn clean install
</code></pre>

<h4>
<a id="troubleshooting" class="anchor" href="#troubleshooting" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Troubleshooting</h4>

<ul>
<li>Edit logger.properties file and set com.trezoragent.level = FINE for more detailed logging. </li>
<li>Application log is saved in your C:\Users\...\ directory under default name: Trezor_Agent.log</li>
<li>You can also access log by using the "Open Log File" item in the application tray menu.</li>
<li>If you are getting "Device not ready" message, try closing your Chrome browser and re-plug the device</li>
<li>Also make sure that SSH Server you are connecting to supports ECDSA:

<ul>
<li>ECDSA is generally supported since <a href="http://www.openssh.com/txt/release-5.7">OpenSSH 5.7</a>
</li>
<li>But there are backports to some older openSSH versions, e.g. Redhat/CentOS <a href="http://www.rpmfind.net/linux/RPM/centos/updates/6.7/x86_64/Packages/openssh-5.3p1-112.el6_7.x86_64.html">5.3p1-112.el6_7</a>
</li>
</ul>
</li>
</ul>

<h3>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h3>

<ul>
<li>Please  <a href="http://www.chiark.greenend.org.uk/%7Esgtatham/putty/download.html">download</a> Putty or WinSCP version that supports ECDSA keys. Certified Putty versions: 0.67+, 0.66, 0.65</li>
<li>After started the app, find Trezor icon in Windows tray area and right click to open menu.
<img src="https://github.com/martin-lizner/commons/raw/master/trezor-ssh-agent/menu1.png" alt="Menu">
</li>
<li>Click "Show Public Key" to get your openSSH public key. Provide PIN/Passphrase if asked. Place key on SSH server in your user authorized_keys file.</li>
<li>Start Putty with "Attempt authentication using Pageant" option selected (Connection-&gt;SSH-&gt;Auth).
<img src="https://github.com/martin-lizner/commons/raw/master/trezor-ssh-agent/putty.png" alt="Putty">
</li>
<li>Use Putty to connect to your favorite SSH server.</li>
<li>Provide PIN/Passphrase if asked.</li>
<li>Confirm identity sign operation on the device - "SSH login to: btc.rulez".
<img src="https://github.com/martin-lizner/commons/raw/master/trezor-ssh-agent/login.png" alt="Success">
</li>
</ul>

<h4>
<a id="keepkey-users" class="anchor" href="#keepkey-users" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>KeepKey Users</h4>

<ul>
<li>Make sure Chrome browser is switched off if you have KeepKey extension installed - else you may get <strong>KeepKey not ready</strong> warning.</li>
<li>After started the Trezor SSH Agent use "Edit Settings" menu item to set DEVICE=keepkey property in the settings file.

<ul>
<li>You can also access settings file in your Windows user directory under name Trezor_Agent.properties</li>
</ul>
</li>
<li>After you have made changes to settings file, please restart the Trezor SSH Agent.</li>
</ul>

<h4>
<a id="advanced" class="anchor" href="#advanced" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Advanced</h4>

<ul>
<li>Using the "Edit Settings" menu you can edit some Trezor SSH Agent properties saved in the settings file. After you make the changes, make sure you restart the app for changes to take effect.</li>
<li>You can customize the BIP32 URI and Index values that are used to derive your unique device key. This is also text which is displayed on the device when confirming the login operation. Please be aware that BIP32_URI must comfor <a href="http://www.ietf.org/rfc/rfc2396.txt">Java URI</a> as well as <a href="https://github.com/satoshilabs/slips/blob/master/slip-0013.md">SLIP-0013</a> so avoid using chars like underscore.</li>
<li>SESSION_TIMEOUT property defines minutes of idle time after device automatically locks itself. Display stays on, but PIN and passphrase cache is reseted after timeout. Idle time is zeroed after each successful pubkey or sign operation.</li>
</ul>

<h4>
<a id="agent-forwarding" class="anchor" href="#agent-forwarding" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Agent Forwarding</h4>

<p>You can also use Trezor SSH Agent with "agent forwarding" option set in SSH client. This would enable chaining connections back to original agent.
Example:</p>

<ol>
<li>Open SSH to UNIX with agent forwarding enabled in Putty.</li>
<li>From UNIX shell command line open another ssh connection (e.g. ssh root@localhost) to server which trusts your public key.</li>
<li>Confirm operation on the device and you are logged in.</li>
</ol>

<h4>
<a id="public-key-example" class="anchor" href="#public-key-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Public Key Example</h4>

<p><code>ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKJHh8o1FNgyEXzPLIc7tlk4n+4/mLlCs/m/SY7+WsUhdoajyHiyP0Zdo+VuWAizLTApW68QIzqWY73fur+i7nk= Trezor</code></p>

<h3>
<a id="credits" class="anchor" href="#credits" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Credits</h3>

<ul>
<li>Martin Lizner - author</li>
<li>Gary Rowe (MultiBit) - <a href="https://github.com/bitcoin-solutions/multibit-hardware">Trezor Java API</a>
</li>
<li>Roman Zeyde - <a href="https://github.com/romanz/trezor-agent">Trezor SSH Agent in Python</a>
</li>
</ul>

<p>Bitcoin donations: 1QEKWJFAqwkCxPotJoGpfaFDnaShjiNtb5 </p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">trezor-ssh-agent maintained by <a href="https://github.com/martin-lizner">martin-lizner</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
